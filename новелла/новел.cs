using System;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        Random random = new Random();
        int шагов = 0;
        List<string> история = new List<string>();

        string[] места = {
            "в нос",
            "в рот",
            "в дупло дерева",
            "в ухо",
            "в розетку (неповезло!)",
            "в варенье",
            "в муравейник",
            "в кастрюлю с супом",
            "в носок великана",
            "в банку с огурцами",
            "в нору крота",
            "в карман ведьмы",
            "в пасть дракона",
            "в книгу магии",
            "в аквариум к пираньям",
            "в портал на Марс",
            "в унитаз",
            "в арбуз",
            "в телевизор",
            "в волшебное зеркало"
        };

        string[] концовки = {
            "Палец стал золотым. Мальчик теперь богач. Конец.",
            "Палец начал говорить. Его наняли на телевидение. Конец.",
            "Палец отвалился, но вырос второй. Теперь мальчик — мутант. Конец.",
            "Палец исчез. Мальчик стал философом. Конец.",
            "Палец превратился в принцессу. Свадьба. Конец.",
            "Палец стал USB-флешкой на 512 ГБ. Практично. Конец.",
            "Палец проглотила сова. Мальчик стал магом. Конец.",
            "Палец оказался бомбой замедленного действия. Бум. Конец.",
            "Палец был ключом к порталу. Теперь мальчик в Нарнии. Конец.",
            "Король отрезал палец и сделал его волшебной палочкой. Мальчик остался без пальца, но со славой. Конец."
        };

        Console.WriteLine(" Добро пожаловать в новеллу 'Пальчик судьбы'");
        Console.WriteLine("Вы — мальчик, и вы очень любите совать пальчик... куда попало.");
        Console.WriteLine("Сделайте выбор. Каждый выбор может привести к неожиданным последствиям!");
        Console.WriteLine("Введите 'выход' в любой момент, чтобы закончить приключение.\n");

        while (true)
        {
            if (шагов >= 20)
            {
                string концовка = концовки[random.Next(концовки.Length)];
                Console.WriteLine("\n✨ ИТОГ: " + концовка);
                Console.Write("Хотите сыграть снова? (да/нет): ");
                string ответ = Console.ReadLine().ToLower();
                if (ответ == "нет") break;
                шагов = 0;
                история.Clear();
                Console.WriteLine("\n--- Новая история начинается! ---\n");
                continue;
            }

            Console.WriteLine($"\nШаг {шагов + 1}: Куда вы хотите сунуть пальчик?");
            for (int i = 0; i < места.Length; i++)
            {
                Console.WriteLine($"{i + 1}. {места[i]}");
            }

            Console.Write("Ваш выбор (1-20): ");
            string ввод = Console.ReadLine();

            if (ввод.ToLower() == "выход") break;

            if (int.TryParse(ввод, out int выбор) && выбор >= 1 && выбор <= места.Length)
            {
                string место = места[выбор - 1];
                Console.WriteLine($"Вы суёте пальчик {место}...");
                история.Add(место);
                шагов++;
            }
            else
            {
                Console.WriteLine("Ошибка ввода. Пожалуйста, введите число от 1 до 20.");
            }
        }

        Console.WriteLine("\nСпасибо за игру! Ваш путь пальчика был:");
        foreach (var шаг in история)
        {
            Console.WriteLine($"- Пальчик {шаг}");
        }
        Console.WriteLine("До новых пальчиковых приключений!");
    }
}